<html>
  <head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script type="text/javascript">
      google.charts.load("current", { packages: ["corechart"] });
      google.charts.setOnLoadCallback(loadData);

      function loadData() {
        const url =
          "https://samples.openweathermap.org/data/2.5/forecast?lat=0&lon=0&appid=xxx";

        fetch(url)
          .then(response => response.json())
          .then(json => drawChart(json))
          .catch(err => console.error("Erreur API :", err));
      }

      function drawChart(apiData) {
        // Création du tableau
        var data = new google.visualization.DataTable();
        data.addColumn("string", "Date");
        data.addColumn("number", "Température (°C)");

        // OpenWeatherMap renvoie la température en Kelvin → conversion en °C
        apiData.list.forEach(entry => {
          const date = entry.dt_txt;
          const tempC = entry.main.temp - 273.15;
          data.addRow([date, Math.round(tempC * 10) / 10]);
        });

        var options = {
          title: "Évolution des températures - Tawarano",
          legend: { position: "none" },
          hAxis: { title: "Date / Heure", slantedText: true, slantedTextAngle: 45 },
          vAxis: { title: "Température (°C)" }
        };

        var chart = new google.visualization.Histogram(
          document.getElementById("chart_div")
        );

        chart.draw(data, options);
      }
    </script>
  </head>

  <body>
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  </body>
</html>
